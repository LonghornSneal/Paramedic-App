<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0" >
    <title>Paramedic Quick Reference</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Baloo+2:wght@600&display=swap" rel="stylesheet">
    <!-- Local Stylesheet -->
    <link rel="stylesheet" href="styles.css" >
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Viewport height fix for mobile browsers -->
    <script src="viewportFix.js" defer></script>
</head>
<body class="bg-gray-100">
<!-- Sidebar Overlay -->
<div id="sidebar-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"></div>
<!-- Patient Info Sidebar -->
<div id="patient-sidebar" class="hidden">
  <!-- Close Button at top of sidebar -->
  <div class="flex justify-end mb-2">
    <button type="button" id="close-sidebar-button" aria-label="Close Patient Info Sidebar" title="Close Sidebar"
            class="p-2 rounded-full text-gray-500 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-400">
      <!-- Close (X) icon -->
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
           stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>
  <!-- Section: Basic Info -->
  <div class="sidebar-section">
    <h2 class="sidebar-section-title">Patient Details</h2>
    <div class="sidebar-field sidebar-field-sex mb-3">
      <span class="sidebar-label">Sex:</span>
      <input type="hidden" id="pt-gender" value="">
      <div class="sex-picker" role="group" aria-label="Patient sex selection">
        <button type="button" class="sex-option" data-value="female" data-tooltip="Female" aria-label="Female">
          <span class="sex-icon" aria-hidden="true">
            <svg class="sex-icon-svg" viewBox="0 0 24 24" role="presentation" aria-hidden="true">
              <circle class="sex-icon-ring" cx="12" cy="8" r="5"></circle>
              <line class="sex-icon-stem" x1="12" y1="13" x2="12" y2="20"></line>
              <line class="sex-icon-cross" x1="9" y1="17" x2="15" y2="17"></line>
            </svg>
          </span>
          <span class="sr-only">Female</span>
        </button>
        <button type="button" class="sex-option" data-value="male" data-tooltip="Male" aria-label="Male">
          <span class="sex-icon" aria-hidden="true">
            <svg class="sex-icon-svg" viewBox="0 0 24 24" role="presentation" aria-hidden="true">
              <circle class="sex-icon-ring" cx="10" cy="12" r="5"></circle>
              <line class="sex-icon-stem" x1="13.5" y1="8.5" x2="19" y2="3"></line>
              <line class="sex-icon-arrow" x1="17" y1="3" x2="19" y2="3"></line>
              <line class="sex-icon-arrow" x1="19" y1="3" x2="19" y2="5"></line>
            </svg>
          </span>
          <span class="sr-only">Male</span>
        </button>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-age mb-3">
      <label for="pt-age" class="sidebar-label">Age:</label>
      <div class="age-unit-toggle-group" role="group" aria-label="Select age units">
        <button type="button" class="age-unit-toggle age-unit-toggle--day" data-unit="days" data-tooltip="Days" aria-label="Days">
          <span class="age-icon" aria-hidden="true">
            <img src="Assets/age/age-days.jpg" alt="" class="age-icon-img">
          </span>
          <span class="sr-only">Days</span>
        </button>
        <button type="button" class="age-unit-toggle age-unit-toggle--month" data-unit="months" data-tooltip="Months" aria-label="Months">
          <span class="age-icon" aria-hidden="true">
            <img src="Assets/age/age-months.jpg" alt="" class="age-icon-img">
          </span>
          <span class="sr-only">Months</span>
        </button>
        <button type="button" class="age-unit-toggle age-unit-toggle--year" data-unit="years" data-tooltip="Years" aria-label="Years">
          <span class="age-icon" aria-hidden="true">
            <img src="Assets/age/age-years.jpg" alt="" class="age-icon-img">
          </span>
          <span class="sr-only">Years</span>
        </button>
      </div>
      <input type="number" id="pt-age" class="sidebar-input age-input age-input--compact" inputmode="decimal" step="any">
    </div>
    <div class="sidebar-field sidebar-field-weight mb-2">
      <label for="pt-weight-value" class="sidebar-label">Weight:</label>
      <div class="weight-unit-toggle-group" role="group" aria-label="Select weight units">
        <button type="button" class="weight-unit-toggle" data-unit="kg" aria-label="Kilograms">kg</button>
        <button type="button" class="weight-unit-toggle" data-unit="lb" aria-label="Pounds">lbs</button>
      </div>
      <input type="number" id="pt-weight-value" class="sidebar-input weight-input" placeholder="kg" inputmode="decimal" step="any">
      <div id="weight-summary" class="weight-summary hidden" aria-live="polite"></div>
    </div>
    <div class="sidebar-field sidebar-field-height mb-1">
      <label for="pt-height-ft" class="sidebar-label">Height:</label>
      <div class="height-inline-inputs">
        <input type="number" id="pt-height-ft" class="sidebar-input height-input height-input--compact" inputmode="numeric" aria-label="Feet" step="any">
        <span class="height-unit-text">ft</span>
        <input type="number" id="pt-height-in" class="sidebar-input height-input height-input--compact" inputmode="numeric" aria-label="Inches" step="any">
        <span class="height-unit-text">in</span>
      </div>
    </div>
  </div>
  <!-- Section: Medical History -->
  <div class="sidebar-section">
    <h2 class="sidebar-section-title">Medical History</h2>
    <label for="pt-pmh" class="sidebar-label">Past Medical History:</label>
    <div class="autocomplete-container">
      <textarea id="pt-pmh" rows="1" class="sidebar-input w-full"></textarea>
      <div id="pt-pmh-suggestions" class="autocomplete-suggestions hidden"></div>
    </div>
    <label for="pt-allergies" class="sidebar-label mt-3">Allergies:</label>
    <div class="autocomplete-container">
      <textarea id="pt-allergies" rows="1" class="sidebar-input w-full"></textarea>
      <div id="pt-allergies-suggestions" class="autocomplete-suggestions hidden"></div>
    </div>
    <label for="pt-medications" class="sidebar-label mt-3">Current Medications:</label>
    <div class="autocomplete-container">
      <textarea id="pt-medications" rows="1" class="sidebar-input w-full"></textarea>
      <div id="pt-medications-suggestions" class="autocomplete-suggestions hidden"></div>
    </div>
  </div>
  <!-- Section: Current Presentation -->
  <div class="sidebar-section">
    <h2 class="sidebar-section-title">Current Presentation</h2>
    <label for="pt-indications" class="sidebar-label">Indications:</label>
    <div class="autocomplete-container">
      <textarea id="pt-indications" rows="1" class="sidebar-input w-full"></textarea>
      <div id="pt-indications-suggestions" class="autocomplete-suggestions hidden"></div>
    </div>
    <label for="pt-symptoms" class="sidebar-label mt-3">Symptoms:</label>
    <div class="autocomplete-container">
      <textarea id="pt-symptoms" rows="1" class="sidebar-input w-full"></textarea>
      <div id="pt-symptoms-suggestions" class="autocomplete-suggestions hidden"></div>
    </div>
  </div>
  <!-- Section: Vital Signs -->
  <div class="sidebar-section">
    <h2 class="sidebar-section-title">Vital Signs</h2>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-bp-systolic" class="sidebar-label">BP:</label>
      <div class="dual-input-wrapper">
        <div class="bp-input-group" role="group" aria-label="Blood pressure entry">
          <input type="number" id="vs-bp-systolic" class="sidebar-input vital-input vital-input--narrow" inputmode="numeric" min="0" max="400" aria-label="Systolic blood pressure" placeholder="SYS">
          <input type="number" id="vs-bp-diastolic" class="sidebar-input vital-input vital-input--narrow" inputmode="numeric" min="0" max="300" aria-label="Diastolic blood pressure" placeholder="DIA">
        </div>
        <select id="vs-bp-select" class="sidebar-input vital-select" aria-label="Blood pressure preset">
          <option value="" aria-label="No preset"></option>
          <option value="200+">200+</option>
          <option value="160+">160+</option>
          <option value="Normal (90-160 SBP)">Normal (90-160 SBP)</option>
          <option value="70-90">70-90</option>
          <option value="70-">70-</option>
        </select>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-hr-value" class="sidebar-label">HR:</label>
      <div class="dual-input-wrapper">
        <input type="number" id="vs-hr-value" class="sidebar-input vital-input" inputmode="numeric" min="0" max="400" aria-label="Heart rate numeric entry" placeholder="bpm">
        <select id="vs-hr-select" class="sidebar-input vital-select" aria-label="Heart rate preset">
          <option value="" aria-label="No preset"></option>
          <option value="150+">150+</option>
          <option value="100+">100+</option>
          <option value="60-100">60-100</option>
          <option value=">60">&gt;60</option>
          <option value=">40">&gt;40</option>
        </select>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-spo2-value" class="sidebar-label">% SpO2:</label>
      <div class="dual-input-wrapper">
        <input type="number" id="vs-spo2-value" class="sidebar-input vital-input" inputmode="numeric" min="50" max="100" aria-label="Pulse oximetry numeric entry" placeholder="%">
        <select id="vs-spo2-select" class="sidebar-input vital-select" aria-label="Pulse oximetry preset">
          <option value="" aria-label="No preset"></option>
          <option value="Normal">Normal</option>
          <option value="Low">Low</option>
          <option value="Severely Low">Severely Low</option>
        </select>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-etco2" class="sidebar-label">EtCO2:</label>
      <input type="number" id="vs-etco2" class="sidebar-input vital-input" inputmode="numeric" min="0" max="50" aria-label="End tidal CO2" placeholder="mmHg">
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-rr" class="sidebar-label">RR:</label>
      <input type="number" id="vs-rr" class="sidebar-input vital-input" inputmode="numeric" min="0" max="80" aria-label="Respiratory rate" placeholder="rpm">
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-bgl-value" class="sidebar-label">BGL:</label>
      <div class="dual-input-wrapper">
        <input type="number" id="vs-bgl-value" class="sidebar-input vital-input" inputmode="numeric" min="0" max="900" aria-label="Blood glucose numeric entry" placeholder="mg/dL">
        <select id="vs-bgl-select" class="sidebar-input vital-select" aria-label="Blood glucose preset">
          <option value="" aria-label="No preset"></option>
          <option value="Normal">Normal</option>
          <option value="High">High</option>
          <option value="Low">Low</option>
          <option value="Critical">Critical</option>
        </select>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-pupils-value" class="sidebar-label">Pupils (mm):</label>
      <div class="dual-input-wrapper">
        <input type="number" id="vs-pupils-value" class="sidebar-input vital-input" inputmode="numeric" min="0" max="8" step="0.5" aria-label="Pupil size in millimeters" placeholder="mm">
        <select id="vs-pupils-select" class="sidebar-input vital-select" aria-label="Pupil descriptor">
          <option value="" aria-label="No descriptor"></option>
          <option value="PERRL">PERRL</option>
          <option value="Pinpoint">Pinpoint</option>
          <option value="Dilated">Dilated</option>
          <option value="Unequal">Unequal</option>
          <option value="Fixed">Fixed</option>
          <option value="Sluggish">Sluggish</option>
          <option value="Non-reactive">Non-reactive</option>
        </select>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-gcs-value" class="sidebar-label">GCS:</label>
      <div class="dual-input-wrapper">
        <input type="number" id="vs-gcs-value" class="sidebar-input vital-input" inputmode="numeric" min="3" max="15" aria-label="Glasgow Coma Scale numeric entry" placeholder="score">
        <select id="vs-gcs-select" class="sidebar-input vital-select" aria-label="Glasgow Coma Scale preset">
          <option value="" aria-label="No preset"></option>
          <option value="15">15</option>
          <option value="14">14</option>
          <option value="13">13</option>
          <option value="12">12</option>
          <option value="11">11</option>
          <option value="10">10</option>
          <option value="9">9</option>
          <option value="8">8</option>
          <option value="7">7</option>
          <option value="6">6</option>
          <option value="5">5</option>
          <option value="4">4</option>
          <option value="3">3</option>
        </select>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-ao-status" class="sidebar-label">A&O Status:</label>
      <select id="vs-ao-status" class="sidebar-input vital-select">
        <option value=""></option>
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
      </select>
    </div>
    <div class="sidebar-field sidebar-field-vital mb-3">
      <label for="vs-lung-sounds" class="sidebar-label">Lung Sounds:</label>
      <div class="autocomplete-container flex-1">
        <input type="text" id="vs-lung-sounds" class="sidebar-input vital-input" placeholder="Search lung sounds">
        <div id="vs-lung-sounds-suggestions" class="autocomplete-suggestions hidden"></div>
      </div>
    </div>
  </div>
  <!-- Section: EKG -->
  <div class="sidebar-section">
    <div class="sidebar-section-header">
      <h2 class="sidebar-section-title">EKG Interpretation</h2>
      <button type="button" id="ekg-help-button" class="sidebar-help-button" aria-haspopup="dialog" aria-controls="ekg-help-modal">Help</button>
    </div>
    <div class="sidebar-field sidebar-field-ekg mb-3">
      <label for="pt-ekg-select" class="sidebar-label">Rhythm:</label>
      <div class="ekg-field-row">
        <div class="ekg-select-group">
          <select id="pt-ekg-select" class="sidebar-input vital-select" aria-label="EKG rhythm preset">
            <option value="" aria-label="No rhythm selected"></option>
          </select>
          <div class="autocomplete-container ekg-autocomplete">
            <input type="text" id="pt-ekg" class="sidebar-input vital-input" placeholder="Type or select rhythm">
            <div id="pt-ekg-suggestions" class="autocomplete-suggestions hidden"></div>
          </div>
        </div>
        <div class="ekg-preview-shell" aria-hidden="true">
          <img id="ekg-rhythm-preview" alt="" class="ekg-preview-img">
        </div>
        <button type="button" id="ekg-rhythm-info" class="ekg-info-button" aria-label="View rhythm definition" disabled>i</button>
      </div>
    </div>
    <div class="sidebar-field sidebar-field-ekg mb-3">
      <label for="pt-ekg-secondary" class="sidebar-label">MI/BBB/Sgarbossa:</label>
      <div class="ekg-field-row">
        <select id="pt-ekg-secondary" class="sidebar-input vital-select" aria-label="EKG modifier preset">
          <option value="" aria-label="No modifier selected"></option>
        </select>
        <div class="ekg-preview-shell" aria-hidden="true">
          <img id="ekg-modifier-preview" alt="" class="ekg-preview-img">
        </div>
        <button type="button" id="ekg-modifier-info" class="ekg-info-button" aria-label="View modifier definition" disabled>i</button>
      </div>
    </div>
  </div>

</div>

<div id="settings-panel" class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white p-4 rounded-lg shadow-lg">
    <div class="flex justify-end mb-2">
        <button type="button" id="close-settings-button" aria-label="Close Settings" title="Close Settings" class="p-2 rounded-full text-gray-500 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-400">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>
    </div>
    <h2 class="text-xl font-semibold text-center mb-4">Settings</h2>
    <div class="flex items-center justify-between">
        <label for="dark-mode-toggle" class="mr-2 text-gray-800">Dark Mode</label>
        <input type="checkbox" id="dark-mode-toggle" class="w-5 h-5" >
    </div>
</div>

<div id="app-container" class="flex flex-col min-h-screen">

    <!-- Application Header -->
        <header class="bg-blue-600 text-white py-0 sticky top-0 z-40 shadow-md">
        <div class="container mx-auto flex items-start">
            <div class="flex-shrink-0">
                <button type="button" id="open-sidebar-button" class="header-nav-button" aria-label="Open Patient Info Sidebar" title="Patient Info">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" /></svg>
                </button>
            </div>
            <div class="flex-grow text-center">
                <h1 class="text-lg sm:text-xl md:text-2xl font-semibold">Paramedic Quick Reference</h1>
                <div class="mt-2">
                    <input type="search" id="searchInput" placeholder="Search topics or medications..." class="w-full p-sm-3 rounded-lg border-2 border-blue-400 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-300 focus:border-blue-300" aria-label="Search Treatment Information" >
                </div>
                <!-- Compact Patient Snapshot Bar below search -->
                <div id="patient-snapshot-bar" class="mt-2 text-sm text-yellow-400"></div>
            </div>
            <div class="flex-sm-shrink-4 flex-start items-end">
                <div class="flex space-x-1">
                    <button type="button" id="nav-back-button" class="header-nav-button" aria-label="Navigate Back" title="Back" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg>
                    </button>
                    <button type="button" id="nav-forward-button" class="header-nav-button" aria-label="Navigate Forward" title="Forward" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" /></svg>
                    </button>
                </div>
                <button type="button" id="nav-home-button" class="header-nav-button mt-sm-2" aria-label="Home" title="Home">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                </button>
                <button type="button" id="history-button" class="header-nav-button mt-2" aria-label="History" title="History">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                </button>
                <!-- History Dropdown Panel (hidden by default) -->
            <div id="history-panel" class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white p-4 rounded-lg shadow-lg max-h-96 overflow-y-auto z-50">
                <div class="flex justify-end mb-2">
                    <button type="button" id="close-history-button" aria-label="Close History" title="Close History" class="p-2 rounded-full text-gray-500 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-400">
                        <!-- Close (X) icon (same SVG markup as used in other close buttons) -->
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <h2 class="text-xl font-semibold text-center mb-4">History</h2>
                <div id="history-list" class="space-y-1"></div>
            </div>
            </div>
        </div>
    </header>


    <!-- Main Content Area -->
    <main class="w-full p-1">
    <div id="content-area" class="bg-white p-3 md:p-6 rounded-lg shadow-lg min-h-[calc(var(--vh,1vh)*100-220px)]">
        <p class="text-gray-500 text-center">Loading categories...</p>
    </div>
    </main>
    <!-- Application Footer -->
    <footer class="text-center p-4 text-gray-500 text-sm">
  App Version 0.7
      <button type="button" id="settings-button" class="ml-4">Settings</button>
    </footer>
</div>
<script type="module" src="main.js"></script>

<div id="ekg-help-backdrop" class="modal-backdrop hidden"></div>
<div id="ekg-help-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="ekg-help-title">
  <div class="modal-content">
    <button type="button" id="ekg-help-close" class="modal-close" aria-label="Close EKG help">&times;</button>
    <h3 id="ekg-help-title">EKG Interpretation</h3>
    <div id="ekg-modal-general">
      <p class="modal-intro">
        Use these quick cues when selecting a rhythm or modifier. The info buttons beside each selector open detailed previews with definitions.
      </p>
      <ul class="modal-list">
        <li><strong>Sinus Tachycardia:</strong> Regular rhythm, rate &gt; 100 bpm, upright P before each QRS.</li>
        <li><strong>Sinus Bradycardia:</strong> Regular rhythm, rate &lt; 60 bpm, upright P before each QRS.</li>
        <li><strong>Atrial Fibrillation:</strong> Irregularly irregular rhythm with absent P waves and fibrillatory baseline.</li>
        <li><strong>SVT:</strong> Narrow-complex tachycardia &gt; 150 bpm, P waves often hidden.</li>
        <li><strong>Ventricular Tachycardia:</strong> Wide-complex rhythm &gt; 100 bpm, monomorphic or polymorphic morphology.</li>
      </ul>
    </div>
    <div id="ekg-modal-detail" class="ekg-modal-detail hidden">
      <h4 id="ekg-modal-detail-title"></h4>
      <img id="ekg-modal-detail-image" alt="" class="ekg-modal-detail-image">
      <p id="ekg-modal-detail-definition" class="ekg-modal-detail-definition"></p>
      <button type="button" id="ekg-modal-back" class="modal-back-button">Back</button>
    </div>
  </div>
</div>

</body>
</html>


